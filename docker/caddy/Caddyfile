{
	email {$CLOUDFLARE_EMAIL}
}

(cloudflare) {
	encode gzip
	tls {
		dns cloudflare {env.CLOUDFLARE_API_TOKEN}
	}
}

{$CLOUDFLARE_DOMAIN} {
	import cloudflare

	handle_path /api* {
		reverse_proxy http://cuida_caucaia_api:8000 {
			header_up Host {host}
			header_up X-Real-IP {remote_host}
			transport http {
				response_header_timeout 3600s
				dial_timeout 3600s
				read_timeout 3600s
			}
		}
	}

	handle_path /* {
		reverse_proxy http://cuida_caucaia_webui:8501 {
			header_up Host {host}
			header_up X-Real-IP {remote_host}
			transport http {
				versions 1.1
			}
		}
	}
}
